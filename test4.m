clear all

 x0 = [zeros(4,1); zeros(4,1)];

 ts = [0 0.5]
 
% [t,x] = ode45(@f,ts,x0);
%  plot(t,x(:,2),t,x(:,3),'--')
 
  M = 0.009*eye(4);
K = (85.2/21000)*1e+04*[    4.2000   -2.1000         0         0;
   -2.1000    4.2000   -2.1000         0;
         0   -2.1000    4.2000   -2.1000;
         0         0   -2.1000    4.2000];
 eig(M^(-1/2)*K*M^(-1/2))
 

  function v = f(t,x)
    M = 0.009*eye(4);
    K = 1e+04*[    4.2000   -2.1000         0         0;
       -2.1000    4.2000   -2.1000         0;
             0   -2.1000    4.2000   -2.1000;
             0         0   -2.1000    4.2000];

    C =  [4    -2     0     0
        -2     4    -2     0
         0    -2     4    -2
         0     0    -2     2];
     B = [0.05;0;0;0];
     w = 2;
     
     A1 = [zeros(4) eye(4); -inv(M)*K -inv(M)*C];
     f = inv(M)*B;
     v = A1*x+[zeros(4,1);f]*sin(w*t);
  end
 
  
